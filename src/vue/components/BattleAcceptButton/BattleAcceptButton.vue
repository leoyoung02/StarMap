<template>
  <button class="BattleAcceptButton" @click="$emit('click')">
    <div class="BattleAcceptButton__svg">
      <svg viewBox="0 0 743 794" fill="none">
        <path opacity="0.1" d="M371.495 793.155C335.535 793.155 300.055 783.655 268.915 765.685L103.525 670.195C40.255 633.675 0.915039 565.565 0.915039 492.465V301.535C0.915039 228.455 40.235 160.355 103.515 123.815L268.885 28.335C300.085 10.335 335.545 0.834961 371.495 0.834961C407.445 0.834961 442.895 10.325 474.035 28.285L639.465 123.795C702.775 160.365 742.075 228.455 742.075 301.525V492.455C742.075 565.545 702.755 633.645 639.455 670.185L474.105 765.645C442.935 783.635 407.455 793.135 371.495 793.135V793.155Z" stroke="#00FFFF" stroke-width="0.25" stroke-miterlimit="10"/>
        <path opacity="0.18" d="M631.285 137.975C689.545 171.625 725.715 234.295 725.715 301.535V492.465C725.715 559.725 689.525 622.395 631.285 656.025L465.935 751.495C437.245 768.055 404.605 776.795 371.505 776.795C338.405 776.795 305.765 768.055 277.105 751.515L111.725 656.025C53.4949 622.415 17.2949 559.745 17.2949 492.465V301.535C17.2949 234.285 53.4749 171.625 111.705 137.985L277.065 42.505C305.775 25.945 338.415 17.205 371.495 17.205C404.575 17.205 437.205 25.945 465.855 42.465L631.275 137.975H631.285Z" stroke="#00FFFF" stroke-width="1.14" stroke-miterlimit="10"/>
        <path opacity="0.26" d="M623.095 152.145C676.305 182.875 709.345 240.115 709.345 301.535V492.465C709.345 553.895 676.295 611.145 623.095 641.855L457.745 737.325C431.545 752.445 401.725 760.435 371.495 760.435C341.265 760.435 311.455 752.445 285.275 737.345L119.895 641.865C66.705 611.165 33.645 553.925 33.645 492.475V301.545C33.645 240.125 66.685 182.885 119.875 152.165L285.245 56.6749C311.465 41.5449 341.275 33.5649 371.495 33.5649C401.715 33.5649 431.505 41.5449 457.685 56.6449L623.095 152.145Z" stroke="#00FFFF" stroke-width="2.02" stroke-miterlimit="10"/>
        <path opacity="0.35" d="M614.915 166.315C663.075 194.135 692.985 245.935 692.985 301.525V492.455C692.985 548.065 663.075 599.875 614.915 627.675L449.565 723.145C425.855 736.835 398.865 744.065 371.495 744.065C344.125 744.065 317.145 736.835 293.455 723.165L128.075 627.685C79.9349 599.905 50.0049 548.085 50.0049 492.475V301.545C50.0049 245.955 79.9149 194.145 128.055 166.335L293.425 70.8649C317.155 57.1749 344.145 49.9449 371.495 49.9449C398.845 49.9449 425.815 57.1649 449.505 70.8349L614.915 166.335V166.315Z" stroke="#00FFFF" stroke-width="2.91" stroke-miterlimit="10"/>
        <path opacity="0.43" d="M606.735 180.485C649.845 205.385 676.625 251.765 676.625 301.525V492.455C676.625 542.235 649.845 588.615 606.735 613.505L441.385 708.975C420.155 721.225 395.995 727.695 371.495 727.695C346.995 727.695 322.845 721.225 301.625 708.985L136.255 613.505C93.155 588.635 66.375 542.245 66.375 492.465V301.535C66.375 251.765 93.145 205.385 136.245 180.495L301.605 85.0249C322.855 72.7649 347.005 66.2949 371.495 66.2949C395.985 66.2949 420.125 72.7649 441.335 84.9949L606.735 180.485Z" stroke="#00FFFF" stroke-width="3.8" stroke-miterlimit="10"/>
        <path opacity="0.51" d="M598.555 194.655C636.625 216.645 660.255 257.585 660.255 301.525V492.455C660.255 536.405 636.615 577.355 598.555 599.325L433.205 694.795C414.465 705.615 393.125 711.325 371.505 711.325C349.885 711.325 328.545 705.615 309.815 694.805L144.445 599.325C106.395 577.365 82.7451 536.405 82.7451 492.455V301.525C82.7451 257.585 106.385 216.635 144.435 194.655L309.795 99.1849C328.555 88.3649 349.875 82.6549 371.495 82.6549C393.115 82.6549 414.435 88.3649 433.155 99.1649L598.545 194.655H598.555Z" stroke="#00FFFF" stroke-width="4.68" stroke-miterlimit="10"/>
        <path opacity="0.59" d="M590.375 208.825C623.395 227.895 643.895 263.415 643.895 301.525V492.455C643.895 530.575 623.385 566.095 590.375 585.155L425.025 680.625C408.765 690.005 390.265 694.965 371.505 694.965C352.745 694.965 334.245 690.005 317.995 680.635L152.625 585.155C119.615 566.105 99.105 530.585 99.105 492.455V301.525C99.105 263.415 119.615 227.895 152.615 208.825L317.975 113.355C334.245 103.965 352.745 99.015 371.495 99.015C390.245 99.015 408.735 103.965 424.985 113.335L590.365 208.825H590.375Z" stroke="#00FFFF" stroke-width="5.57" stroke-miterlimit="10"/>
        <path opacity="0.67" d="M582.195 223.005C610.165 239.165 627.535 269.245 627.535 301.535V492.465C627.535 524.755 610.165 554.855 582.195 570.995L416.845 666.465C403.075 674.415 387.395 678.615 371.505 678.615C355.615 678.615 339.935 674.415 326.175 666.475L160.815 570.995C132.855 554.855 115.475 524.765 115.475 492.465V301.535C115.475 269.245 132.845 239.155 160.805 223.005L326.165 127.535C339.945 119.585 355.615 115.385 371.505 115.385C387.395 115.385 403.055 119.585 416.815 127.515L582.195 222.995V223.005Z" stroke="#00FFFF" stroke-width="6.45" stroke-miterlimit="10"/>
        <path opacity="0.75" d="M574.005 237.175C596.925 250.415 611.165 275.075 611.165 301.535V492.465C611.165 518.935 596.925 543.595 574.005 556.825L408.655 652.295C397.375 658.805 384.525 662.245 371.495 662.245C358.465 662.245 345.625 658.805 334.345 652.295L168.985 556.825C146.065 543.595 131.825 518.935 131.825 492.465V301.535C131.825 275.075 146.065 250.415 168.975 237.175L334.335 141.705C345.625 135.185 358.475 131.745 371.495 131.745C384.515 131.745 397.355 135.185 408.635 141.685L574.005 237.165V237.175Z" stroke="#00FFFF" stroke-width="7.34" stroke-miterlimit="10"/>
        <path opacity="0.84" d="M565.825 251.345C583.705 261.665 594.805 280.895 594.805 301.535V492.465C594.805 513.105 583.705 532.335 565.835 542.655L400.485 638.125C391.685 643.205 381.665 645.885 371.505 645.885C361.345 645.885 351.325 643.205 342.535 638.125L177.175 542.655C159.305 532.345 148.195 513.105 148.195 492.465V301.535C148.195 280.905 159.295 261.675 177.165 251.345L342.525 155.875C351.335 150.795 361.345 148.115 371.505 148.115C381.665 148.115 391.675 150.795 400.465 155.875L565.825 251.345Z" stroke="#00FFFF" stroke-width="8.23" stroke-miterlimit="10"/>
        <path opacity="0.92" d="M557.645 265.515C570.475 272.925 578.435 286.725 578.435 301.535V492.465C578.435 507.275 570.465 521.075 557.645 528.485L392.295 623.955C385.985 627.595 378.795 629.525 371.505 629.525C364.215 629.525 357.025 627.595 350.715 623.955L185.365 528.485C172.535 521.085 164.575 507.285 164.575 492.465V301.535C164.575 286.725 172.545 272.925 185.365 265.515L350.715 170.045C357.035 166.405 364.225 164.475 371.505 164.475C378.785 164.475 385.975 166.405 392.295 170.045L557.645 265.515Z" stroke="#00FFFF" stroke-width="9.11" stroke-miterlimit="10"/>
        <path d="M371.495 613.155C367.065 613.155 362.705 611.985 358.885 609.775L193.535 514.305C185.755 509.815 180.925 501.445 180.925 492.455V301.525C180.925 292.545 185.755 284.175 193.535 279.675L358.885 184.205C362.715 181.995 367.075 180.825 371.495 180.825C375.915 180.825 380.275 181.995 384.105 184.205L549.455 279.675C557.235 284.165 562.065 292.535 562.065 301.525V492.455C562.065 501.435 557.235 509.805 549.455 514.305L384.105 609.775C380.275 611.985 375.915 613.155 371.495 613.155Z" stroke="#00FFFF" stroke-width="10" stroke-miterlimit="10"/>
        <g filter="url(#filter0_i_70_2973)">
          <path d="M371.495 603.155C368.825 603.155 366.195 602.445 363.885 601.115L198.535 505.645C193.835 502.935 190.925 497.885 190.925 492.465V301.535C190.925 296.115 193.845 291.065 198.545 288.355L363.895 192.885C366.205 191.555 368.845 190.845 371.505 190.845C374.165 190.845 376.805 191.555 379.125 192.885L544.475 288.345C549.175 291.055 552.085 296.105 552.085 301.525V492.455C552.085 497.875 549.165 502.925 544.475 505.635L379.125 601.105C376.815 602.435 374.185 603.145 371.515 603.145L371.495 603.155Z" fill="#00FFFF" fill-opacity="0.01"/>
        </g>
        <path
          v-if="progress < 100"
          d="M 384.515 131.745 C 384.515 131.745 397.355 135.185 408.635 141.685 L 574.005 237.165 V 237.175 C 596.925 250.415 611.165 275.075 611.165 301.535 V 492.465 C 611.165 518.935 596.925 543.595 574.005 556.825 L 408.655 652.295 C 397.375 658.805 384.525 662.245 371.495 662.245 C 358.465 662.245 345.625 658.805 334.345 652.295 L 168.985 556.825 C 146.065 543.595 131.825 518.935 131.825 492.465 V 301.535 C 131.825 275.075 146.065 250.415 168.975 237.175 L 334.335 141.705 C 345.625 135.185 358.475 131.745 371.495 131.745 Z"
          stroke="#39B24A" 
          stroke-width="22"
          stroke-miterlimit="10"
          :stroke-dasharray="dasharray"
          :stroke-dashoffset="dashoffset"
        />
        <defs>
          <filter id="filter0_i_70_2973" x="190.925" y="190.845" width="361.16" height="412.31" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset/>
            <feGaussianBlur stdDeviation="50"/>
            <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"/>
            <feBlend mode="normal" in2="shape" result="effect1_innerShadow_70_2973"/>
          </filter>
        </defs>
      </svg>
    </div>
    <div class="BattleAcceptButton__text">
      Accept game
    </div>
  </button>
</template>

<script lang="ts">
import { default as animejs } from 'animejs'

export default {
  name: 'BattleAcceptButton',
  props: {
    // seconds
    duration: {
      type: Number,
      required: true,
    },
  },
  emits: ['click', 'timeout'],
  data: () => ({
    progress: 0,
    dasharray: 1611
  }),
  computed: {
    dashoffset() {
      return this.dasharray / 100 * this.progress * -1
    },
  },
  mounted() {
    animejs({
      targets: this,
      progress: [0, 100],
      duration: this.duration * 1000,
      easing: 'linear',
      complete: () => {
        this.$emit('timeout')
      }
    })
  }
};
</script>

<style scoped src="./BattleAcceptButton.css"/>
